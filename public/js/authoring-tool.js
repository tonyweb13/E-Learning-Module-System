let imageFile,fileFile,imageIndex=0,tempfilename=null,extension=null;function fontEditor(e,o){document.execCommand(e,!1,o)}function getImageSize(){$("#authoring-tool-image-modal").modal("hide"),w2=$("#width2-url").val(),h2=$("#height2-url").val(),imageIndex++,$("#editor").append(`<img src="'/images/no_image.png'" onerror="this.src='/images/no_image.png'" \n                        width="${w2}px;" height="${h2}px;" class="geo-border-primary border mt-2" id="image-${imageIndex}">`),$("#editor_image_select").click()}function dismissImageModal(){$("#authoring-tool-image-modal").modal("hide")}function getFrameSize(){$("#authoring-tool-frame-modal").modal("hide"),w=$("#width-url").val(),h=$("#height-url").val(),imageIndex++,$("#editor").append(`<iframe src="https://www.w3schools.com" id="vidoe-${imageIndex}" style="width:${w}px; height: ${h}px;" \n                            class="geo-border-primary border mt-2" controlsList="nodownload"></iframe>`),$("#editor_image_select2").click()}function fileLinkShow(e){$("#document-preview-frame").attr("src",e),$("#view2-modal").modal("hide"),$("#create-modal").modal("hide"),$("#file-preview-modal").modal("show")}function appendLink(){link=$("#link-url").val(),displaytext=$("#link-display-text").val(),$("#editor").append(`<a id="link-${imageIndex}" href="${link}">${displaytext}</a>`),$("#authoring-tool-link-modal").modal("hide"),$("#link-url").val(""),$("#link-display-text").val("")}function dismissLinkModal(){$("#authoring-tool-link-modal").modal("hide")}function dismissEmbeedModal(){$("#authoring-tool-embeed-modal").modal("hide")}function dismissFrameModal(){$("#authoring-tool-frame-modal").modal("hide")}function appendEmbeed(){imageIndex++,link=$("#link-embeed-url").val(),1==link.includes("youtu.be")?(result=/[^\/]*$/.exec(link)[0],$("#editor").append(`<iframe src="https://www.youtube.com/embed/${result}" id="frame-${imageIndex}" style="width: 100%; height: 600px;" class="geo-border-primary border mt-2" controlsList="nodownload"></iframe>`)):1==link.includes("youtube")?(result=link.substring(link.indexOf("=")+1),console.log(result),$("#editor").append(`<iframe src="https://www.youtube.com/embed/${result}" id="frame-${imageIndex}" style="width: 100%; height: 600px;" class="geo-border-primary border mt-2" controlsList="nodownload"></iframe>`)):$("#editor").append(`<iframe src="${link}" id="frame-${imageIndex}" style="width: 100%; height: 600px;" class="geo-border-primary border mt-2" controlsList="nodownload"></iframe>`),$("#authoring-tool-embeed-modal").modal("hide"),$("#link-embeed-url").val("")}function setColor(e){document.execCommand("styleWithCSS",!1,!0),document.execCommand("foreColor",!1,e)}function setBackColor(e){document.execCommand("styleWithCSS",!1,!0),document.execCommand("BackColor",!1,e)}$(document).ready(function(){$("#editControls a").click(function(e){switch(e.preventDefault(),$(this).data("role")){case"h1":case"h2":case"h3":case"h4":case"h5":case"p":document.execCommand("formatBlock",!1,$(this).data("role"));break;default:document.execCommand($(this).data("role"),!1,null)}}),$("#editor").keyup(function(){$(this).html()}).keyup(),$("#editor").keydown(function(e){if(9===e.keyCode){var o=this.selectionStart;end=this.selectionEnd;var i=$(this);return i.val(i.val().substring(0,o)+"\t"+i.val().substring(end)),document.execCommand("insertText",!1,"          "),this.selectionStart=this.selectionEnd=o+1,!1}})}),$("#editor_select_img").click(function(){$("#authoring-tool-image-modal").modal("show")}),$("#editor_image_select").change(function(){if(this.files&&this.files[0]){var e=new FileReader;e.onload=function(e){showLoader("Uploading!","Please wait...");var o=$("#editor_image_select").prop("files")[0],i=new FormData;i.append("imageFile",o),$.ajax({type:"post",url:"/upload/image",data:i,method:"POST",dataType:"json",contentType:!1,cache:!1,processData:!1,success:function(e){console.log(e),"error"==e?($(`#image-${imageIndex}`).remove(),showErrorAlert("Error","Please check your internet connection")):$(`#image-${imageIndex}`).attr("src",e),Swal.close()},error:function(e){showHttpErrorAlert(e)}})},ext=this.files[0].type,ext.includes("image")?e.readAsDataURL(this.files[0]):($(`#image-${imageIndex}`).remove(),showWarningAlert("Warning","Please select image"))}}),$("#editor_select_img2").click(function(){$("#authoring-tool-frame-modal").modal("show")}),$("#editor_image_select2").change(function(){if(this.files&&this.files[0]){var e=new FileReader;e.onload=function(e){showLoader("Uploading!","Please wait...");var o=$("#editor_image_select2").prop("files")[0],i=new FormData;i.append("videoFile",o),console.log(o),console.log(i),$.ajax({type:"post",url:"/upload/video",data:i,method:"POST",dataType:"json",contentType:!1,cache:!1,processData:!1,success:function(e){console.log(e),"error"==e?($(`#vidoe-${imageIndex}`).remove(),showErrorAlert("Error","Please check your internet connection")):$(`#vidoe-${imageIndex}`).attr("src",e),Swal.close()},error:function(e){showHttpErrorAlert(e)}})},ext=this.files[0].type,console.log(ext),ext.includes("video")||ext.includes("audio")?e.readAsDataURL(this.files[0]):($(`#vidoe-${imageIndex}`).remove(),showWarningAlert("Warning","Please select video or audio"))}}),$("#editor_select_img3").click(function(){imageIndex++,$("#editor_image_select3").click()}),$("#editor_image_select3").change(function(){if(this.files&&this.files[0]){var e=new FileReader;e.onload=function(e){showLoader("Uploading!","Please wait...");var o=$("#editor_image_select3").prop("files")[0],i=new FormData;i.append("fileFile",o),console.log(o),console.log(i),$.ajax({type:"post",url:"/upload/file",data:i,method:"POST",dataType:"json",contentType:!1,cache:!1,processData:!1,success:function(e){console.log(e),"error"==e?showErrorAlert("Error","Please check your internet connection"):(console.log(1),console.log(extension),"pdf"==extension?tmp=e:"doc"==extension||"docx"==extension||"docm"==extension?(gid=e.match(/[-\w]{25,}/),console.log(gid[0]),tmp=`https://docs.google.com/document/d/${gid}/edit`):"ppt"==extension||"pptx"==extension?(gid=e.match(/[-\w]{25,}/),console.log(gid[0]),tmp=`https://docs.google.com/presentation/d/${gid}/edit`):"xlsx"!=extension&&"xlsm"!=extension&&"xlsb"!=extension&&"xltx"!=extension&&"xltm"!=extension&&"xls"!=extension&&"xlt"!=extension&&"xml"!=extension&&"xlam"!=extension&&"xla"!=extension&&"xlw"!=extension&&"xlr"!=extension||(gid=e.match(/[-\w]{25,}/),console.log(gid[0]),tmp=`https://docs.google.com/spreadsheets/d/${gid}/edit`),console.log(tmp),tempfilename=filename,$("#editor").append(`<button type="button" class="btn btn-light" value="${tmp}" onclick="fileLinkShow(this.value)">${filename}</button>`),extension=null),Swal.close()},error:function(e){showHttpErrorAlert(e)}})},ext=this.files[0].type,console.log(ext),ext.includes("application")?(filename=this.files[0].name,extension=filename.split(".").pop(),e.readAsDataURL(this.files[0])):showWarningAlert("Warning","Please select documents")}}),$("#link-btn").click(function(){$("#authoring-tool-link-modal").modal("show")}),$("#embed-video-btn").click(function(){$("#authoring-tool-embeed-modal").modal("show")});